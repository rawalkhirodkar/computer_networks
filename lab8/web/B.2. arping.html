<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0042)http://linux-ip.net/html/tools-arping.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:cf="http://docbook.sourceforge.net/xmlns/chunkfast/1.0"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>B.2.&nbsp;arping</title><link rel="stylesheet" href="./B.2. arping_files/linux-ip.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.0"><meta name="keywords" content="linux, ip, iproute2, ifconfig, firewall, ARP, NAT, route, routing, route selection, routing selection, network administration"><link rel="start" href="http://linux-ip.net/html/index.html" title="Guide to IP Layer Network Administration with Linux"><link rel="up" href="http://linux-ip.net/html/tools-ethernet.html" title="Appendix B. Ethernet Layer Tools"><link rel="prev" href="http://linux-ip.net/html/tools-arp.html" title="B.1. arp"><link rel="next" href="http://linux-ip.net/html/tools-ip-link.html" title="B.3. ip link"><meta xmlns="http://www.w3.org/TR/xhtml1/transitional" name="generator" content="Experimental LDP.XSL $Revision: 1.2 $">
  <!-- Generated by LDP XSLT customization layer
      based on Norman Walsh's DocBook XSL stylesheets.
      More information at http://www.linuxdoc.org/ -->
  <style type="text/css"></style><script type="text/javascript" src="http://ads.dfgio.com/loader.js?client=topaz0003"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">B.2.&nbsp;<span><strong class="command">arping</strong></span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="http://linux-ip.net/html/tools-arp.html">Prev</a>&nbsp;</td><th width="60%" align="center">Appendix&nbsp;B.&nbsp;Ethernet Layer Tools</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="http://linux-ip.net/html/tools-ip-link.html">Next</a></td></tr></tbody></table><hr></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="tools-arping"></a>B.2.&nbsp;<span><strong class="command">arping</strong></span></h2></div></div></div><p>
        An almost unknown command (mostly because it is not frequently
        necessary), the <span><strong class="command">arping</strong></span> utility performs an action
        similar to <a href="http://linux-ip.net/html/tools-ping.html" title="G.1. ping"><span><strong class="command">ping</strong></span></a>,
        but at the Ethernet layer.   Where <span><strong class="command">ping</strong></span> tests the
        reachability of an IP address, <span><strong class="command">arping</strong></span> reports the
        reachability and round-trip time of an IP address hosted on the local
        network.
      </p><p>
        There are several modes of operation for this utility.  Under normal
        operation, <span><strong class="command">arping</strong></span> displays the Ethernet and IP
        address of the target as well as the time elapsed between the
        arp request and the arp reply.
      </p><div class="example"><a id="ex-tools-arping-listing"></a><p class="title"><b>Example&nbsp;B.4.&nbsp;Displaying reachability of an IP on the local Ethernet with <span>arping</span></b></p><table xmlns="http://www.w3.org/TR/xhtml1/transitional" border="0" bgcolor="#E0E0E0" width="90%"><tbody><tr><td><pre class="programlisting"><code xmlns="http://www.w3.org/1999/xhtml" class="prompt">[root@masq-gw]# </code><strong xmlns="http://www.w3.org/1999/xhtml" class="userinput"><code>arping -I eth0 -c 2 192.168.100.17</code></strong>
<code xmlns="http://www.w3.org/1999/xhtml" class="computeroutput">ARPING 192.168.100.17 from 192.168.100.254 eth0
Unicast reply from 192.168.100.17 [00:80:C8:E8:4B:8E]  8.419ms
Unicast reply from 192.168.100.17 [00:80:C8:E8:4B:8E]  2.095ms
Sent 2 probes (1 broadcast(s))
Received 2 response(s)</code>
        </pre></td></tr></tbody></table></div><p>
        Other options to the arping utility include the ability to send a
        broadcast arp using the <span><strong class="command">-U</strong></span> option
        and the ability to send a gratuitous reply using the
        <span><strong class="command">-A</strong></span> option.   A kernel with support for <a href="http://linux-ip.net/html/adv-nonlocal-bind.html" title="9.7. Binding to Non-local Addresses">non-local bind</a> can be used with
        arping for the nefarious purpose of wreaking havoc on
        an otherwise properly configured Ethernet.  By performing gratuitous arp
        and broadcasting incorrect arp information, arp tables in poorly
        designed IP stacks can become quite confused.
      </p><p>
        <span><strong class="command">arping</strong></span> can detect if an IP address is
        currently in use on an Ethernet.  Called duplicate address detection,
        this use of <span><strong class="command">arping</strong></span> is increasingly common in
        networking scripts.
      </p><p>
        For a practical example, let's assume a laptop named
        <code class="systemitem">dietrich</code> is normally
        connected to a home network with the same IP address as
        <code class="systemitem">tristan</code> of
        our main office network.  In the boot scripts,
        <code class="systemitem">dietrich</code>
        might make good use of
        <span><strong class="command">arping</strong></span> by testing reachability of the IP it wants
        to use before bringing up the IP layer.
      </p><div class="example"><a id="ex-tools-arping-dad"></a><p class="title"><b>Example&nbsp;B.5.&nbsp;Duplicate Address Detection with <span>arping</span></b></p><table xmlns="http://www.w3.org/TR/xhtml1/transitional" border="0" bgcolor="#E0E0E0" width="90%"><tbody><tr><td><pre class="programlisting"><code xmlns="http://www.w3.org/1999/xhtml" class="prompt">[root@dietrich]# </code><strong xmlns="http://www.w3.org/1999/xhtml" class="userinput"><code>arping -D -q -I eth0 -c 2 192.168.99.35</code></strong>
<code xmlns="http://www.w3.org/1999/xhtml" class="prompt">[root@dietrich]# </code><strong xmlns="http://www.w3.org/1999/xhtml" class="userinput"><code>echo $?</code></strong>
<code xmlns="http://www.w3.org/1999/xhtml" class="computeroutput">1</code>
<code xmlns="http://www.w3.org/1999/xhtml" class="prompt">[root@dietrich]# </code><strong xmlns="http://www.w3.org/1999/xhtml" class="userinput"><code>arping -D -q -I eth0 -c 2 192.168.99.36</code></strong>
<code xmlns="http://www.w3.org/1999/xhtml" class="prompt">[root@dietrich]# </code><strong xmlns="http://www.w3.org/1999/xhtml" class="userinput"><code>echo $?</code></strong>
<code xmlns="http://www.w3.org/1999/xhtml" class="computeroutput">0</code>
        </pre></td></tr></tbody></table></div><p>
        First, <code class="systemitem">dietrich</code> tests
        reachability of its preferred IP (192.168.99.35).  Because the IP
        address is in use by
        <code class="systemitem">tristan</code>, 
        <code class="systemitem">dietrich</code> receives a
        response.  Any response by a device on the Ethernet indicating that an
        IP address is in use will cause the <span><strong class="command">arping</strong></span> command
        to exit with a non-zero exit code (specifically, exit code 1).
      </p><p>
        Note, that the Ethernet device must already be in an UP state (see
        <a href="http://linux-ip.net/html/tools-ip-link.html" title="B.3. ip link">Section&nbsp;B.3, “<span><strong class="command">ip link</strong></span>”</a>).  If the Ethernet device has not been
        brought up, the <span><strong class="command">arping</strong></span> utility will exit with a
        non-zero exit code (specifically, exit code 2).
      </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a accesskey="p" href="http://linux-ip.net/html/tools-arp.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="http://linux-ip.net/html/tools-ethernet.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="http://linux-ip.net/html/tools-ip-link.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">B.1.&nbsp;<span><strong class="command">arp</strong></span>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="http://linux-ip.net/html/index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;B.3.&nbsp;<span><strong class="command">ip link</strong></span></td></tr></tbody></table></div>
</body></html>